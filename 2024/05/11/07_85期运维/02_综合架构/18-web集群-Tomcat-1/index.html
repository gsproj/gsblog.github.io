

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="GongSheng">
  <meta name="keywords" content="">
  
    <meta name="description" content="Web集群-Tomcat（一）今日内容：  JAVA容器介绍 JAVA环境介绍 Tomcat上手  一、JAVA容器什么是java容器？  用于存放java代码的环境，就叫java容器 web中间件，很多就是java容器，见下表     java容器     Tomcat 最常用，较重，功能完善.   Jetty 轻量，功能较少.   Weblogic 用于Oracle数据库环境使用，Weblog">
<meta property="og:type" content="article">
<meta property="og:title" content="17-Web集群-Tomcat(一)">
<meta property="og:url" content="http://gsproj.github.io/2024/05/11/07_85%E6%9C%9F%E8%BF%90%E7%BB%B4/02_%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/18-web%E9%9B%86%E7%BE%A4-Tomcat-1/index.html">
<meta property="og:site_name" content="迎风之豚的博客">
<meta property="og:description" content="Web集群-Tomcat（一）今日内容：  JAVA容器介绍 JAVA环境介绍 Tomcat上手  一、JAVA容器什么是java容器？  用于存放java代码的环境，就叫java容器 web中间件，很多就是java容器，见下表     java容器     Tomcat 最常用，较重，功能完善.   Jetty 轻量，功能较少.   Weblogic 用于Oracle数据库环境使用，Weblog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240511160105925.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240511163252296.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240511163938313.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240511170000316.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240511171222761.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513103228645.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513103255698.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513114215670.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513114343742.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513114715123.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513134404186.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513140124888.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513140438636.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513140505383.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513142656034.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513142716314.png">
<meta property="og:image" content="http://gsproj.github.io/img/image-20240513142730577.png">
<meta property="article:published_time" content="2024-05-11T07:23:52.000Z">
<meta property="article:modified_time" content="2024-08-02T01:48:34.361Z">
<meta property="article:author" content="GongSheng">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://gsproj.github.io/img/image-20240511160105925.png">
  
  
  
  <title>17-Web集群-Tomcat(一) - 迎风之豚的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"gsproj.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Haris的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="17-Web集群-Tomcat(一)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-05-11 15:23" pubdate>
          2024年5月11日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4.5k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          38 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">17-Web集群-Tomcat(一)</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Web集群-Tomcat（一）"><a href="#Web集群-Tomcat（一）" class="headerlink" title="Web集群-Tomcat（一）"></a>Web集群-Tomcat（一）</h1><p>今日内容：</p>
<ul>
<li>JAVA容器介绍</li>
<li>JAVA环境介绍</li>
<li>Tomcat上手</li>
</ul>
<h1 id="一、JAVA容器"><a href="#一、JAVA容器" class="headerlink" title="一、JAVA容器"></a>一、JAVA容器</h1><p>什么是java容器？</p>
<ul>
<li>用于存放java代码的环境，就叫java容器</li>
<li>web中间件，很多就是java容器，见下表</li>
</ul>
<table>
<thead>
<tr>
<th>java容器</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Tomcat</td>
<td>最常用，较重，功能完善.</td>
</tr>
<tr>
<td>Jetty</td>
<td>轻量，功能较少.</td>
</tr>
<tr>
<td>Weblogic</td>
<td>用于Oracle数据库环境使用，Weblogic属于甲骨文．</td>
</tr>
<tr>
<td>东方通</td>
<td>国产java容器</td>
</tr>
</tbody></table>
<h1 id="二、JAVA环境"><a href="#二、JAVA环境" class="headerlink" title="二、JAVA环境"></a>二、JAVA环境</h1><p>JAVA环境分为三部分：</p>
<ul>
<li>JVM: java 虚拟机，运行java代码的地方.</li>
<li>JRE: java Runtime Enviroment，java运行环境 。提供jvm环境，java命令。</li>
<li>JDK: Java Development Kit，java开发环境 , jvm+jre+额外功能</li>
</ul>
<p>图示如下：</p>
<p><img src="/../../../img/image-20240511160105925.png" srcset="/img/loading.gif" lazyload alt="image-20240511160105925"></p>
<blockquote>
<p>提示：</p>
<p>未来部署JDK即可，主要版本JDK1.8 或称 JDK8</p>
<p>JDK - ORACLE所有，未授权仅允许个人研究</p>
<p>OPenJDK - 开源，允许商用</p>
</blockquote>
<h1 id="三、Tomcat极速上手"><a href="#三、Tomcat极速上手" class="headerlink" title="三、Tomcat极速上手"></a>三、Tomcat极速上手</h1><h2 id="3-1-环境准备"><a href="#3-1-环境准备" class="headerlink" title="3.1 环境准备"></a>3.1 环境准备</h2><table>
<thead>
<tr>
<th>环境</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>web03</td>
<td>10.0.0.9&#x2F;172.16.1.9</td>
<td>tomcat</td>
</tr>
<tr>
<td>web04</td>
<td>10.0.0.10&#x2F;172.16.1.10</td>
<td>tomcat</td>
</tr>
<tr>
<td>db01</td>
<td>10.0.0.51&#x2F;172.16.1.51</td>
<td></td>
</tr>
</tbody></table>
<h2 id="3-2-部署JDK"><a href="#3-2-部署JDK" class="headerlink" title="3.2 部署JDK"></a>3.2 部署JDK</h2><p>版本：JDK-8u411</p>
<p>下载：<a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/downloads/#java8">https://www.oracle.com/java/technologies/downloads/#java8</a></p>
<p>部署</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"># 解压
tar -vxf jdk-8u411-linux-x64.tar.gz -C &#x2F;app&#x2F;tools&#x2F;

# 创建软连接
ln -s &#x2F;app&#x2F;tools&#x2F;jdk1.8.0_411&#x2F; &#x2F;app&#x2F;tools&#x2F;jdk

# 配置JAVA环境变量
[root@web03[ &#x2F;app&#x2F;tools]#tail -n 4 &#x2F;etc&#x2F;profile
# JDK环境
export JAVA_HOME&#x3D;&#x2F;app&#x2F;tools&#x2F;jdk
export PATH&#x3D;$JAVA_HOME&#x2F;bin:$JAVA_HOME&#x2F;jre&#x2F;bin:$PATH
export CLASSPATH&#x3D;.$CLASSPATH:$JAVA_HOME&#x2F;lib:$JAVA_HOME&#x2F;jre&#x2F;lib:$JAVA_HOME&#x2F;lib&#x2F;tools.jar

# 生效
source &#x2F;etc&#x2F;profile

# 测试java命令
[root@web03[ &#x2F;app&#x2F;tools]#java -version
java version &quot;1.8.0_411&quot;
Java(TM) SE Runtime Environment (build 1.8.0_411-b09)
Java HotSpot(TM) 64-Bit Server VM (build 25.411-b09, mixed mode)
[root@web03[ &#x2F;app&#x2F;tools]#which java
&#x2F;app&#x2F;tools&#x2F;jdk&#x2F;bin&#x2F;java</code></pre></div></figure>



<h2 id="3-3-部署Tomcat"><a href="#3-3-部署Tomcat" class="headerlink" title="3.3 部署Tomcat"></a>3.3 部署Tomcat</h2><p>版本：9.0.89</p>
<p>下载：<a target="_blank" rel="noopener" href="https://dlcdn.apache.org/tomcat/tomcat-9/v9.0.89/bin/apache-tomcat-9.0.89.tar.gz">https://dlcdn.apache.org/tomcat/tomcat-9/v9.0.89/bin/apache-tomcat-9.0.89.tar.gz</a></p>
<p>部署</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">tar -vxf apache-tomcat-9.0.89.tar.gz -C &#x2F;app&#x2F;tools&#x2F;
ln -s &#x2F;app&#x2F;tools&#x2F;apache-tomcat-9.0.89 &#x2F;app&#x2F;tools&#x2F;tomcat

# 测试
[root@web03[ &#x2F;app&#x2F;tools]#tomcat&#x2F;bin&#x2F;version.sh
Using CATALINA_BASE:   &#x2F;app&#x2F;tools&#x2F;tomcat
Using CATALINA_HOME:   &#x2F;app&#x2F;tools&#x2F;tomcat
Using CATALINA_TMPDIR: &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;temp
Using JRE_HOME:        &#x2F;app&#x2F;tools&#x2F;jdk
Using CLASSPATH:       &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;bootstrap.jar:&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;tomcat-juli.jar
Using CATALINA_OPTS:
Server version: Apache Tomcat&#x2F;9.0.89
Server built:   May 3 2024 20:22:11 UTC
Server number:  9.0.89.0
OS Name:        Linux
OS Version:     3.10.0-1160.el7.x86_64
Architecture:   amd64
JVM Version:    1.8.0_411-b09
JVM Vendor:     Oracle Corporation</code></pre></div></figure>

<p>启动Tomcat</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"># 启动
[root@web03[ &#x2F;app&#x2F;tools]#tomcat&#x2F;bin&#x2F;startup.sh
Using CATALINA_BASE:   &#x2F;app&#x2F;tools&#x2F;tomcat
Using CATALINA_HOME:   &#x2F;app&#x2F;tools&#x2F;tomcat
Using CATALINA_TMPDIR: &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;temp
Using JRE_HOME:        &#x2F;app&#x2F;tools&#x2F;jdk
Using CLASSPATH:       &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;bootstrap.jar:&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;tomcat-juli.jar
Using CATALINA_OPTS:
Tomcat started.

# 查看进程信息, 默认在8080端口监听
[root@web03[ &#x2F;app&#x2F;tools]#ss -lntup | grep java
tcp    LISTEN     0      100    [::]:8080               [::]:*                   users:((&quot;java&quot;,pid&#x3D;2585,fd&#x3D;57))
tcp    LISTEN     0      1        [::ffff:127.0.0.1]:8005               [::]:*                   users:((&quot;java&quot;,pid&#x3D;2585,fd&#x3D;65))


[root@web03[ &#x2F;app&#x2F;tools]#ps -ef | grep java
root       2585      1  9 16:27 pts&#x2F;0    00:00:02 &#x2F;app&#x2F;tools&#x2F;jdk&#x2F;bin&#x2F;java -Djava.util.logging.config.file&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;conf&#x2F;logging.properties -Djava.util.logging.manager&#x3D;org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize&#x3D;2048 -Djava.protocol.handler.pkgs&#x3D;org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK&#x3D;0027 -Dignore.endorsed.dirs&#x3D; -classpath &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;bootstrap.jar:&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;tomcat-juli.jar -Dcatalina.base&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat -Dcatalina.home&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat -Djava.io.tmpdir&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;temp org.apache.catalina.startup.Bootstrap start
root       2628   2312  0 16:27 pts&#x2F;0    00:00:00 grep --color&#x3D;auto java</code></pre></div></figure>

<p>测试访问：<a target="_blank" rel="noopener" href="http://10.0.0.9:8080/">http://10.0.0.9:8080/</a></p>
<p><img src="/../../../img/image-20240511163252296.png" srcset="/img/loading.gif" lazyload alt="image-20240511163252296"></p>
<h1 id="四、Tomcat目录结构"><a href="#四、Tomcat目录结构" class="headerlink" title="四、Tomcat目录结构"></a>四、Tomcat目录结构</h1><h2 id="4-1-目录概述"><a href="#4-1-目录概述" class="headerlink" title="4.1 目录概述"></a>4.1 目录概述</h2><p>Tomcat下有如下目录：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">[root@web03[ &#x2F;app&#x2F;tools]#ll tomcat&#x2F;
total 132
drwxr-x---. 2 root root  4096 May 11 16:25 bin
-rw-r-----. 1 root root 20913 May  4 04:22 BUILDING.txt
drwx------. 3 root root   254 May 11 16:27 conf
-rw-r-----. 1 root root  6210 May  4 04:22 CONTRIBUTING.md
drwxr-x---. 2 root root  4096 May 11 16:25 lib
-rw-r-----. 1 root root 57092 May  4 04:22 LICENSE
drwxr-x---. 2 root root   197 May 11 16:27 logs
-rw-r-----. 1 root root  2333 May  4 04:22 NOTICE
-rw-r-----. 1 root root  3283 May  4 04:22 README.md
-rw-r-----. 1 root root  6901 May  4 04:22 RELEASE-NOTES
-rw-r-----. 1 root root 16505 May  4 04:22 RUNNING.txt
drwxr-x---. 2 root root    30 May 11 16:25 temp
drwxr-x---. 7 root root    81 May  4 04:22 webapps
drwxr-x---. 3 root root    22 May 11 16:27 work</code></pre></div></figure>

<p>重要目录的概述如下</p>
<table>
<thead>
<tr>
<th>目录</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>bin</td>
<td>存放tomcat管理命令</td>
</tr>
<tr>
<td>conf</td>
<td>tomcat配置文件</td>
</tr>
<tr>
<td>lib</td>
<td>依赖与库文件,插件文件</td>
</tr>
<tr>
<td>logs</td>
<td>日志目录</td>
</tr>
<tr>
<td>webapps</td>
<td>站点目录</td>
</tr>
<tr>
<td>work</td>
<td>tomcat运行java代码的存放代码的目录</td>
</tr>
</tbody></table>
<h2 id="4-2-bin目录"><a href="#4-2-bin目录" class="headerlink" title="4.2 bin目录"></a>4.2 bin目录</h2><p>核心文件：</p>
<table>
<thead>
<tr>
<th>bin目录</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>startup.sh</td>
<td>启动脚本</td>
</tr>
<tr>
<td>shutdown.sh</td>
<td>关闭脚本</td>
</tr>
<tr>
<td>catalina.sh</td>
<td>核心脚本,配置tomcat优化,jvm优化</td>
</tr>
</tbody></table>
<h2 id="4-3-conf目录"><a href="#4-3-conf目录" class="headerlink" title="4.3 conf目录"></a>4.3 conf目录</h2><p>核心文件</p>
<table>
<thead>
<tr>
<th>conf配置文件</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>server.xml</td>
<td>tomcat配置文件</td>
</tr>
<tr>
<td>web.xml</td>
<td>配置文件,辅助配置</td>
</tr>
</tbody></table>
<h2 id="4-4-logs目录"><a href="#4-4-logs目录" class="headerlink" title="4.4 logs目录"></a>4.4 logs目录</h2><table>
<thead>
<tr>
<th>logs目录</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>catalina.out</td>
<td>tomcat应用日志,启动过程,关闭,错误信息 <br/><strong>核心找</strong>：startup启动用时,错误提示:error,failed,exception</td>
</tr>
<tr>
<td>catalina.2022-09-15.log</td>
<td>catalina.out的切割日志.按照每天进行切割.</td>
</tr>
<tr>
<td>localhost_access_log.2022-09-15.txt</td>
<td>访问日志,未来可以重新定义名字和内容</td>
</tr>
</tbody></table>
<h2 id="4-5-webapps目录"><a href="#4-5-webapps目录" class="headerlink" title="4.5 webapps目录"></a>4.5 webapps目录</h2><p>站点目录<br>war包，自动解压，自动部署  </p>
<h1 id="五、Tomcat日常管理与访问"><a href="#五、Tomcat日常管理与访问" class="headerlink" title="五、Tomcat日常管理与访问"></a>五、Tomcat日常管理与访问</h1><h2 id="5-1-日常启动与维护"><a href="#5-1-日常启动与维护" class="headerlink" title="5.1 日常启动与维护"></a>5.1 日常启动与维护</h2><p>启动tomcat查看日志</p>
<p><img src="/../../../img/image-20240511163938313.png" srcset="/img/loading.gif" lazyload alt="image-20240511163938313"></p>
<p>浏览器测试访问：<a target="_blank" rel="noopener" href="http://10.0.0.9:8080/">http://10.0.0.9:8080/</a>  </p>
<h2 id="5-2-systemctl管理配置文件介绍"><a href="#5-2-systemctl管理配置文件介绍" class="headerlink" title="5.2 systemctl管理配置文件介绍"></a>5.2 systemctl管理配置文件介绍</h2><p>如果纯靠手动执行<code>startup.sh</code>脚本来维护tomcat，有些费时费力，可以把这些工作写成systemctl服务，用服务来自动管理。</p>
<p>服务管理指令存放：<code>/usr/lib/systemd/system/xxxx.service</code>，</p>
<p>分为3个部分：Unit、Service、Install</p>
<p>修改或设置systemctl配置要进行重新加载配置  </p>
<p>比如sshd服务的配置</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">[root@web03[ &#x2F;app&#x2F;tools]#cat &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;sshd.service
[Unit]
Description&#x3D;OpenSSH server daemon
Documentation&#x3D;man:sshd(8) man:sshd_config(5)
After&#x3D;network.target sshd-keygen.service
Wants&#x3D;sshd-keygen.service

[Service]
Type&#x3D;notify
EnvironmentFile&#x3D;&#x2F;etc&#x2F;sysconfig&#x2F;sshd
ExecStart&#x3D;&#x2F;usr&#x2F;sbin&#x2F;sshd -D $OPTIONS
ExecReload&#x3D;&#x2F;bin&#x2F;kill -HUP $MAINPID
KillMode&#x3D;process
Restart&#x3D;on-failure
RestartSec&#x3D;42s

[Install]
WantedBy&#x3D;multi-user.target</code></pre></div></figure>

<p>各项解释如下：</p>
<table>
<thead>
<tr>
<th>配置文件结构</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong><font color=red>[Unit]</font></strong></td>
<td>指定注释信息,依赖(先后顺序)</td>
</tr>
<tr>
<td>Description</td>
<td>说明与注释</td>
</tr>
<tr>
<td>After</td>
<td>在这里指定的服务之后运行. network.target</td>
</tr>
<tr>
<td><strong><font color=red>[Service]</font></strong></td>
<td>用于指定服务开启命令,关闭命令,重启命令.</td>
</tr>
<tr>
<td>Type&#x3D;notify</td>
<td>指定类型 simple 或forking即可</td>
</tr>
<tr>
<td>ExecStart</td>
<td>服务启动命令</td>
</tr>
<tr>
<td>ExecStop</td>
<td>服务关闭命令</td>
</tr>
<tr>
<td>ExecReload</td>
<td>重启命令</td>
</tr>
<tr>
<td>EnvironmentFile</td>
<td>配置环境变量的文件(一般对于编译安装,二进制安装需要加上)</td>
</tr>
<tr>
<td><strong><font color=red>[Install]</font></strong></td>
<td>内容固定,用于指定运行级别.</td>
</tr>
<tr>
<td>WantedBy&#x3D;multi-user.target</td>
<td>运行级别,一般都是多用户模式.</td>
</tr>
</tbody></table>
<h2 id="5-3-创建systemctl文件"><a href="#5-3-创建systemctl文件" class="headerlink" title="5.3 创建systemctl文件"></a>5.3 创建systemctl文件</h2><p>创建环境变量文件</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">[root@web03[ &#x2F;etc&#x2F;sysconfig]#cat &#x2F;etc&#x2F;sysconfig&#x2F;tomcat
JAVA_HOME&#x3D;&#x2F;app&#x2F;tools&#x2F;jdk
PATH&#x3D;$JAVA_HOME&#x2F;bin:$JAVA_HOME&#x2F;jre&#x2F;bin:&#x2F;usr&#x2F;bin&#x2F;:&#x2F;usr&#x2F;sbin&#x2F;:&#x2F;usr&#x2F;local&#x2F;bin&#x2F;:&#x2F;usr&#x2F;local&#x2F;sbin&#x2F;
CLASSPATH&#x3D;.$CLASSPATH:$JAVA_HOME&#x2F;lib:$JAVA_HOME&#x2F;jre&#x2F;lib:$JAVA_HOME&#x2F;lib&#x2F;tools.jar</code></pre></div></figure>

<p>创建tomcat systemctl文件</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">[root@web03[ &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system]#cat tomcat.service
[Unit]
Description&#x3D;Tomcat java web container
After&#x3D;network.target

[Service]
Type&#x3D;forking
EnvironmentFile&#x3D;&#x2F;etc&#x2F;sysconfig&#x2F;tomcat
ExecStart&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;startup.sh
ExecStop&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;shutdown.sh
ExecReload&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;shutdown.sh &amp;&amp; sleep 1 &amp;&amp; &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;startup.sh

[Install]
WantedBy&#x3D;multi-user.target</code></pre></div></figure>

<p>重新加载配置（重要，不能忘记！！）</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl daemon-reload</code></pre></div></figure>

<p>测试</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">[root@web03[ &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system]#systemctl enable tomcat.service
Created symlink from &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;multi-user.target.wants&#x2F;tomcat.service to &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;tomcat.service.
[root@web03[ &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system]#systemctl start tomcat.service
[root@web03[ &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system]#systemctl status tomcat.service
● tomcat.service - Tomcat java web container
   Loaded: loaded (&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;tomcat.service; enabled; vendor preset: disabled)
   Active: inactive (dead) since Sat 2024-05-11 16:52:52 CST; 637ms ago
  Process: 2956 ExecStop&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;shutdown.sh (code&#x3D;exited, status&#x3D;0&#x2F;SUCCESS)
  Process: 2931 ExecStart&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;startup.sh (code&#x3D;exited, status&#x3D;0&#x2F;SUCCESS)
 Main PID: 2939 (code&#x3D;exited, status&#x3D;0&#x2F;SUCCESS)

May 11 16:52:49 web03 systemd[1]: Starting Tomcat java web container...
May 11 16:52:49 web03 startup.sh[2931]: Tomcat started.
May 11 16:52:49 web03 systemd[1]: Started Tomcat java web container.</code></pre></div></figure>



<h2 id="5-4-运行站点代码"><a href="#5-4-运行站点代码" class="headerlink" title="5.4 运行站点代码"></a>5.4 运行站点代码</h2><p>开发写的JAVA源代码不能直接部署在Tomcat中，需要对源代码进行编译，生成war包或者jar包</p>
<table>
<thead>
<tr>
<th>分类</th>
<th>说明</th>
<th>应用场景</th>
</tr>
</thead>
<tbody><tr>
<td>war包</td>
<td>需要放在java容器中运行<br/>比如放到tomcat的webapps目录下.<br/>(tomcat会自动加载与运行 war包内容)</td>
<td>功能复杂</td>
</tr>
<tr>
<td>jar包</td>
<td>不需要java容器，内置tomcat<br/>只需要jdk ，通过<code> java -jar xxx.jar</code> 运行</td>
<td></td>
</tr>
</tbody></table>
<h3 id="5-4-1-运行war包案例"><a href="#5-4-1-运行war包案例" class="headerlink" title="5.4.1 运行war包案例"></a>5.4.1 运行war包案例</h3><p>上传memtest.war包，放在webapps目录，然后访问即可</p>
  <figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">[root@web03[ &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;webapps]#ls
docs  examples  host-manager  manager  memtest.war  ROOT</code></pre></div></figure>

<p>测试访问：<a target="_blank" rel="noopener" href="http://10.0.0.9:8080/memtest/meminfo.jsp">http://10.0.0.9:8080/memtest/meminfo.jsp</a></p>
<p><img src="/../../../img/image-20240511170000316.png" srcset="/img/loading.gif" lazyload alt="image-20240511170000316"></p>
<h3 id="5-4-2-运行jar包案例"><a href="#5-4-2-运行jar包案例" class="headerlink" title="5.4.2 运行jar包案例"></a>5.4.2 运行jar包案例</h3><blockquote>
<p>JAR包如果内置了Tomcat，直接指定端口运行即可</p>
</blockquote>
<p>下载程序包：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">wget http:&#x2F;&#x2F;file.nginxwebui.cn&#x2F;nginxWebUI-3.4.0.jar</code></pre></div></figure>

<p>部署</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nohup java -jar -Dfile.encoding&#x3D;UTF-8 &#x2F;home&#x2F;nginxWebUI&#x2F;nginxWebUI-4.0.8.jar --server.port&#x3D;8081 --project.home&#x3D;&#x2F;home&#x2F;nginxWebUI&#x2F; &gt; &#x2F;dev&#x2F;null &amp;</code></pre></div></figure>

<p>参数说明</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>–server.port</td>
<td>占用端口</td>
</tr>
<tr>
<td>–project.home</td>
<td>项目配置文件目录，存放数据库文件，证书文件，<br/>日志等</td>
</tr>
<tr>
<td>&amp;</td>
<td>项目后台运行</td>
</tr>
</tbody></table>
<p>测试访问：<a target="_blank" rel="noopener" href="http://10.0.0.9:8081/adminPage/login">http://10.0.0.9:8081/adminPage/login</a></p>
<p><img src="/../../../img/image-20240511171222761.png" srcset="/img/loading.gif" lazyload alt="image-20240511171222761"></p>
<h2 id="5-6-Tomcat管理端（熟悉即可）"><a href="#5-6-Tomcat管理端（熟悉即可）" class="headerlink" title="5.6 Tomcat管理端（熟悉即可）"></a>5.6 Tomcat管理端（熟悉即可）</h2><p>tomcat管理端：</p>
<ul>
<li>用于web页面管理与查看tomcat信息的功能。</li>
<li>未来对tomcat进行调优的时候需要关闭。</li>
</ul>
<p>开启管理端的方法：</p>
<ol>
<li>修改配置文件tomcat-users.xml</li>
<li>修改安全配置，默认只能127访问，去掉此限制</li>
</ol>
<p>修改配置文件</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">[root@web03[ &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;conf]#cat tomcat-users.xml
&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;
&lt;tomcat-users xmlns&#x3D;&quot;http:&#x2F;&#x2F;tomcat.apache.org&#x2F;xml&quot;
              xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;
              xsi:schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;tomcat.apache.org&#x2F;xml tomcat-users.xsd&quot;
              version&#x3D;&quot;1.0&quot;&gt;
&lt;!-- 添加  --&gt;
&lt;role rolename&#x3D;&quot;manager-gui&quot;&#x2F;&gt;
&lt;role rolename&#x3D;&quot;admin-gui&quot;&#x2F;&gt;
&lt;user username&#x3D;&quot;lidao996&quot; password&#x3D;&quot;1&quot; roles&#x3D;&quot;manager-gui,admin-gui&quot;&#x2F;&gt;
&lt;&#x2F;tomcat-users&gt;</code></pre></div></figure>

<p>去掉只能127网段访问的限制，否则10网段访问将报403错误</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sed -i &#39;s#127#\\d+#g&#39; .&#x2F;host-manager&#x2F;META-INF&#x2F;context.xml .&#x2F;host-manager&#x2F;WEB-INF&#x2F;manager.xml  .&#x2F;manager&#x2F;META-INF&#x2F;context.xml</code></pre></div></figure>

<p>重启服务</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl restart tomcat</code></pre></div></figure>

<p>测试访问：<a target="_blank" rel="noopener" href="http://10.0.0.9:8080/manager/status">http://10.0.0.9:8080/manager/status</a></p>
<p><img src="/../../../img/image-20240513103228645.png" srcset="/img/loading.gif" lazyload alt="image-20240513103228645"></p>
<p>输入配置的账号密码，成功进入</p>
<p><img src="/../../../img/image-20240513103255698.png" srcset="/img/loading.gif" lazyload alt="image-20240513103255698"></p>
<h1 id="六、Tomcat集群"><a href="#六、Tomcat集群" class="headerlink" title="六、Tomcat集群"></a>六、Tomcat集群</h1><h2 id="6-1-Tomcat配置文件详解"><a href="#6-1-Tomcat配置文件详解" class="headerlink" title="6.1 Tomcat配置文件详解"></a>6.1 Tomcat配置文件详解</h2><p>主配置文件：<code>conf/server.xml</code></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&lt;!-- 8085 shutdown端口，连接这个端口输入shutdown字符，就可以关闭tomcat --&gt;
&lt;Server port&#x3D;&quot;8005&quot; shutdown&#x3D;&quot;SHUTDOWN&quot;&gt;

&lt;!-- 管理端认证功能 --&gt;
&lt;GlobalNamingResources&gt;
    &lt;Resource name&#x3D;&quot;UserDatabase&quot; auth&#x3D;&quot;Container&quot;
              type&#x3D;&quot;org.apache.catalina.UserDatabase&quot;
              description&#x3D;&quot;User database that can be updated and saved&quot;
              factory&#x3D;&quot;org.apache.catalina.users.MemoryUserDatabaseFactory&quot;
              pathname&#x3D;&quot;conf&#x2F;tomcat-users.xml&quot; &#x2F;&gt;
  &lt;&#x2F;GlobalNamingResources&gt;

&lt;!-- 8080端口 处理用户Http请求 --&gt;
 &lt;Connector port&#x3D;&quot;8080&quot; protocol&#x3D;&quot;HTTP&#x2F;1.1&quot;
               connectionTimeout&#x3D;&quot;20000&quot;
               redirectPort&#x3D;&quot;8443&quot;
               maxParameterCount&#x3D;&quot;1000&quot;
               &#x2F;&gt;

&lt;!--  Engine部署，指定默认的虚拟主机，这里指定localhost为默认虚拟主机 --&gt;
&lt;Engine name&#x3D;&quot;Catalina&quot; defaultHost&#x3D;&quot;localhost&quot;&gt;

&lt;!-- Host部分，虚拟主机的配置, name就是域名 --&gt;
&lt;Host name&#x3D;&quot;localhost&quot;  appBase&#x3D;&quot;webapps&quot;
            unpackWARs&#x3D;&quot;true&quot; autoDeploy&#x3D;&quot;true&quot;&gt;
        &lt;Valve className&#x3D;&quot;org.apache.catalina.valves.AccessLogValve&quot; directory&#x3D;&quot;logs&quot;
               prefix&#x3D;&quot;localhost_access_log&quot; suffix&#x3D;&quot;.txt&quot;
               pattern&#x3D;&quot;%h %l %u %t &quot;%r&quot; %s %b&quot; &#x2F;&gt;

      &lt;&#x2F;Host&gt;

&lt;!-- 日志记录部分 --&gt;
            &lt;Valve className&#x3D;&quot;org.apache.catalina.valves.AccessLogValve&quot; directory&#x3D;&quot;logs&quot;
               prefix&#x3D;&quot;localhost_access_log&quot; suffix&#x3D;&quot;.txt&quot;
               pattern&#x3D;&quot;%h %l %u %t &quot;%r&quot; %s %b&quot; &#x2F;&gt;
</code></pre></div></figure>

<p>Tomcat配置于nginx配置的对比</p>
<table>
<thead>
<tr>
<th>tomcat</th>
<th>ngx</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>虚拟主机</td>
<td>Host部分</td>
<td>server {}</td>
</tr>
<tr>
<td>域名</td>
<td>name&#x3D;”域名”</td>
<td>server_name java.oldboylinux.cn;</td>
</tr>
<tr>
<td>端口</td>
<td>Connector部分 port&#x3D;”8080”</td>
<td>listen 80;</td>
</tr>
<tr>
<td>站点目录</td>
<td>appBase&#x3D;”webapps”</td>
<td>root &#x2F;app&#x2F;code&#x2F;blog;</td>
</tr>
<tr>
<td>自动解压</td>
<td>unpackWARs&#x3D;”true”</td>
<td>无</td>
</tr>
<tr>
<td>自动部署</td>
<td>autoDeploy&#x3D;”true” 加载到jvm中</td>
<td>无</td>
</tr>
<tr>
<td>日志目录</td>
<td>&lt;Valve 部分 日志目录 directory&#x3D;”logs”</td>
<td>access_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log main;</td>
</tr>
<tr>
<td>日志名字</td>
<td>&lt;Valve 部分前半部分prefix&#x3D;”localhost_access_log” 后半部分suffix&#x3D;”.txt”</td>
<td>access_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log main;</td>
</tr>
<tr>
<td>日志格式</td>
<td>&lt;Valve 部分pattern&#x3D;”%h %l %u %t “%r” %s %b”</td>
<td>log_format main …………….;</td>
</tr>
</tbody></table>
<h2 id="6-2-tomcat访问日志格式"><a href="#6-2-tomcat访问日志格式" class="headerlink" title="6.2 tomcat访问日志格式"></a>6.2 tomcat访问日志格式</h2><p>说明</p>
<table>
<thead>
<tr>
<th>说明</th>
<th>tomcat</th>
<th>nginx</th>
</tr>
</thead>
<tbody><tr>
<td>定义访问日志的格式</td>
<td>Host部分的pattern定义</td>
<td>http区域 log_format部分</td>
</tr>
<tr>
<td>客户端ip地址</td>
<td>%h</td>
<td>$remote_addr</td>
</tr>
<tr>
<td>访问的时间</td>
<td>%t</td>
<td>$local_time</td>
</tr>
<tr>
<td>请求起始行</td>
<td>%r</td>
<td>$request</td>
</tr>
<tr>
<td>状态码</td>
<td>%s</td>
<td>$status</td>
</tr>
<tr>
<td>大小</td>
<td>%b</td>
<td>$body_bytes_sent</td>
</tr>
<tr>
<td>从哪里跳转来的(用户如何访问网站)</td>
<td>%{Referer}i</td>
<td>$http_referer</td>
</tr>
<tr>
<td>客户端类型,浏览器</td>
<td>%{User-Agent}i</td>
<td>$http_user_agent</td>
</tr>
<tr>
<td>XFF头记录</td>
<td>%{X-Forwarded-For}i</td>
<td>$http_x_forwarded_for</td>
</tr>
</tbody></table>
<p>建议配置</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">pattern&#x3D;&quot;%h %l %u %t &quot;%r&quot; %s %b &quot;% &#123;Referer&#125;i&quot; &quot;%&#123;User-Agent&#125;i&quot; &quot;% &#123;X-Forwarded-For&#125;i&quot;&quot; &#x2F;&gt;</code></pre></div></figure>

<blockquote>
<p>其中<code>&amp;quot;</code>表示双引号</p>
</blockquote>
<h2 id="6-3-Tomcat与用户请求"><a href="#6-3-Tomcat与用户请求" class="headerlink" title="6.3 Tomcat与用户请求"></a>6.3 Tomcat与用户请求</h2><p>请求流程：</p>
<ol>
<li>请求与8080端口连接</li>
<li>域名与Host部分的Name进行匹配<ol>
<li>匹配成功：使用对应虚拟主机</li>
<li>匹配失败：使用Engine中定义的default默认虚拟主机</li>
</ol>
</li>
</ol>
<blockquote>
<p>Tomcat可以处理静态与动态的请求：</p>
<ul>
<li>处理静态的效率较低，擅长动态</li>
</ul>
</blockquote>
<h2 id="6-4-案例-部署zrlog应用"><a href="#6-4-案例-部署zrlog应用" class="headerlink" title="6.4 案例-部署zrlog应用"></a>6.4 案例-部署zrlog应用</h2><p>步骤：</p>
<ul>
<li>准备站点war文件</li>
<li>创建数据库、用户</li>
<li>修改Tomcat配置</li>
</ul>
<p>1、代码准备：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"># 上传zrlog的war包到webapps文件夹中
[root@web03[ &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;webapps]#mv &#x2F;root&#x2F;zrlog-2.2.1-efbe9f9-release.war zrlog.war</code></pre></div></figure>

<p>2、创建数据库、用户</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"># 创建数据库
MariaDB [(none)]&gt; create database zrlog;
Query OK, 1 row affected (0.00 sec)

# 创建对应用户
MariaDB [(none)]&gt; grant all on zrlog.* to &#39;zrlog&#39;@&#39;172.16.1.%&#39; identified by &#39;redhat123&#39;;
Query OK, 0 rows affected (0.00 sec)

# 查看
MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| wordpress          |
| zrlog              |
+--------------------+
5 rows in set (0.01 sec)
MariaDB [(none)]&gt; select user,host from mysql.user;
+------------+------------+
| user       | host       |
+------------+------------+
| root       | 127.0.0.1  |
| phpmyadmin | 172.16.1.% |
| wordpress  | 172.16.1.% |
| wp         | 172.16.1.% |
| zrlog      | 172.16.1.% |
| root       | ::1        |
| root       | localhost  |
| wordpress  | localhost  |
+------------+------------+
8 rows in set (0.00 sec)</code></pre></div></figure>

<p>测试访问：</p>
<blockquote>
<p>以上配置并没有未站点配置域名，zrlog.olboy这个域名是通过配置hosts解析设置的，只是为方便站点理解</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">&gt;10.0.0.9 zrlog.oldboylinux.cn</code></pre></div></figure>
</blockquote>
<p>前台：<a target="_blank" rel="noopener" href="http://zrlog.oldboylinux.cn:8080/zrlog/">http://zrlog.oldboylinux.cn:8080/zrlog/</a></p>
<p><img src="/../../../img/image-20240513114215670.png" srcset="/img/loading.gif" lazyload alt="image-20240513114215670"></p>
<p><img src="/../../../img/image-20240513114343742.png" srcset="/img/loading.gif" lazyload alt="image-20240513114343742"></p>
<p>后台管理：<a target="_blank" rel="noopener" href="http://zrlog.oldboylinux.cn:8080/zrlog/admin/">http://zrlog.oldboylinux.cn:8080/zrlog/admin/</a>  </p>
<p><img src="/../../../img/image-20240513114715123.png" srcset="/img/loading.gif" lazyload alt="image-20240513114715123"></p>
<h2 id="6-5-Tomcat的ROOT文件夹"><a href="#6-5-Tomcat的ROOT文件夹" class="headerlink" title="6.5 Tomcat的ROOT文件夹"></a>6.5 Tomcat的ROOT文件夹</h2><p>实现目标：想直接访问到网站，而不是加上网站路径</p>
<p>比如：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"># 现在访问zrlog
http:&#x2F;&#x2F;zrlog.oldboylinux.cn:8080&#x2F;zrlog&#x2F;

# 我想要的
http:&#x2F;&#x2F;zrlog.oldboylinux.cn:8080</code></pre></div></figure>

<p>原理：当访问站点不加上路径时，会直接访问ROOT下面的内容</p>
<p>实现直接访问zrlog：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"># 先删除原有的ROOT文件夹（重命名也可以）
mv ROOT ROOT.old

# 把zrlog.war该名称ROOT.war 
mv zrlog.war ROOT.war

# 会新部署生成ROOT文件夹，老的zrlog可以删了
rm zrlog -fr

# 查看
[root@web03[ &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;webapps]#ls
docs  examples  host-manager  manager  memtest  memtest.war  ROOT  ROOT.old  ROOT.war </code></pre></div></figure>

<p>测试访问：<a target="_blank" rel="noopener" href="http://zrlog.oldboylinux.cn:8080/">http://zrlog.oldboylinux.cn:8080/</a></p>
<p>直接跳到zrlog的安装界面，说明成功</p>
<p><img src="/../../../img/image-20240513134404186.png" srcset="/img/loading.gif" lazyload alt="image-20240513134404186"></p>
<blockquote>
<p>补充：</p>
<p>如果zrlog已经配置完了，后续如何修改数据库的地址？</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">&gt;[root@web03[ &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;webapps]#cat ROOT&#x2F;WEB-INF&#x2F;db.properties
&gt;#This is a database configuration file
&gt;#Mon May 13 13:44:21 CST 2024
&gt;driverClass&#x3D;com.mysql.cj.jdbc.Driver
&gt;user&#x3D;zrlog
&gt;password&#x3D;redhat123
&gt;jdbcUrl&#x3D;jdbc\:mysql\:&#x2F;&#x2F;172.16.1.51\:3306&#x2F;zrlog?characterEncoding\&#x3D;UTF-8&amp;allowPublicKeyRetrieval\&#x3D;true&amp;useSSL\&#x3D;false&amp;serverTimezone\&#x3D;GMT</code></pre></div></figure>
</blockquote>
<h2 id="6-6-Tomcat接入Nginx"><a href="#6-6-Tomcat接入Nginx" class="headerlink" title="6.6 Tomcat接入Nginx"></a>6.6 Tomcat接入Nginx</h2><p>Tomca接入Nginx，其原理是</p>
<p>用户 –访问—&gt; nginx —转发—&gt; Tomcat</p>
<p>Nginx虚拟主机：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">[root@web03[ &#x2F;etc&#x2F;nginx&#x2F;conf.d]#cat zrlog.oldboylinux.cn.conf
server &#123;
  listen 80;
  server_name zrlog.oldboylinux.cn;
  error_log  &#x2F;var&#x2F;log&#x2F;nginx&#x2F;zrlog-error.log notice;
  access_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;zrlog-access.log main;

  # location转发
  location &#x2F; &#123;
    proxy_pass http:&#x2F;&#x2F;127.0.0.1:8080;
    proxy_set_header Host $http_host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  &#125;
&#125;</code></pre></div></figure>

<p>设置Hosts，测试访问：<a target="_blank" rel="noopener" href="http://zrlog.oldboylinux.cn/%EF%BC%8C%E8%BD%AC%E5%8F%91%E6%88%90%E5%8A%9F">http://zrlog.oldboylinux.cn/，转发成功</a></p>
<p><img src="/../../../img/image-20240513140124888.png" srcset="/img/loading.gif" lazyload alt="image-20240513140124888"></p>
<h2 id="6-7-Tomcat-Ngx动静分离"><a href="#6-7-Tomcat-Ngx动静分离" class="headerlink" title="6.7  Tomcat + Ngx动静分离"></a>6.7  Tomcat + Ngx动静分离</h2><p>什么是动静分离：</p>
<ul>
<li>动态资源和静态资源都单独存放</li>
<li>如果需要访问静态资源，Nginx直接返回</li>
<li>如果需要访问动态资源，Nginx再转发给Tomcat处理</li>
</ul>
<blockquote>
<p>前提：需要开发拆分代码，把静态资源拆分出来单独存放.  </p>
</blockquote>
<p>图示：没有动静分离，Ngx一股脑全抛给Tomcat</p>
<p><img src="/../../../img/image-20240513140438636.png" srcset="/img/loading.gif" lazyload alt="image-20240513140438636"></p>
<p>图示：有动静分离，Nginx处理静态资源，Tomcat处理动态资源</p>
<p><img src="/../../../img/image-20240513140505383.png" srcset="/img/loading.gif" lazyload alt="image-20240513140505383"></p>
<h2 id="6-8-Tomcat创建多个实例"><a href="#6-8-Tomcat创建多个实例" class="headerlink" title="6.8 Tomcat创建多个实例"></a>6.8 Tomcat创建多个实例</h2><p>目标：在同一台Linux主机上运行多个Tomcat实例</p>
<p>原因：可以充分利用服务器资源</p>
<p>步骤：</p>
<ul>
<li>创建多个tomcat目录</li>
<li>配置文件端口8080，8005，改掉防止冲突</li>
<li>启动</li>
</ul>
<p>创建多个Tomcat目录</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">tar xf apache-tomcat-9.0.65.tar.gz
cp -r apache-tomcat-9.0.65 tomcat-8081
cp -r apache-tomcat-9.0.65 tomcat-8082
mv tomcat-808* &#x2F;app&#x2F;tools&#x2F;</code></pre></div></figure>

<p>修改配置</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sed -i &#39;s#8005#8006#g&#39; tomcat-8081&#x2F;conf&#x2F;server.xml
sed -i &#39;s#8080#8081#g&#39; tomcat-8081&#x2F;conf&#x2F;server.xml
sed -i &#39;s#8005#8007#g&#39; tomcat-8082&#x2F;conf&#x2F;server.xml
sed -i &#39;s#8080#8082#g&#39; tomcat-8082&#x2F;conf&#x2F;server.xml</code></pre></div></figure>

<p>手动启动</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-she" data-language="she"><code class="language-she">echo java oldboylinux 8081 &gt;&#x2F;app&#x2F;tools&#x2F;tomcat-
8081&#x2F;webapps&#x2F;ROOT&#x2F;lidaojsp
echo java oldboylinux 8082 &gt;&#x2F;app&#x2F;tools&#x2F;tomcat-
8082&#x2F;webapps&#x2F;ROOT&#x2F;lidao.jsp</code></pre></div></figure>

<p>测试访问</p>
<blockquote>
<p>建议：</p>
<p>未来生产上，可以直接把tomcat+应用整体打包，使用的时候直接解压即可  </p>
</blockquote>
<h2 id="6-9-监控功能"><a href="#6-9-监控功能" class="headerlink" title="6.9 监控功能"></a>6.9 监控功能</h2><h3 id="6-9-1-监控概述"><a href="#6-9-1-监控概述" class="headerlink" title="6.9.1 监控概述"></a>6.9.1 监控概述</h3><p>作用：</p>
<ul>
<li>通过各种监控工具(Zabbix&#x2F;Grafana&#x2F;Prometheus&#x2F;….)来监控Tomcat&#x2F;java.</li>
<li>需要我们开启java远程监控功能(JMX remote)</li>
</ul>
<h3 id="6-9-2-配置步骤"><a href="#6-9-2-配置步骤" class="headerlink" title="6.9.2 配置步骤"></a>6.9.2 配置步骤</h3><p>tomcat配置中修改tomcat启动的选项，开启jmx远程监控功能。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"># 备份文件
[root@web03[ &#x2F;app&#x2F;tools&#x2F;tomcat]#cp bin&#x2F;catalina.sh bin&#x2F;catalina.sh.bak

# 编辑catalina.sh，125行之后加
# 从tomcat 8.5开始 配置的每一行要通过\进行续行
CATALINA_OPTS&#x3D;&quot;$CATALINA_OPTS \
 -Dcom.sun.management.jmxremote \
 -Dcom.sun.management.jmxremote.port&#x3D;12345 \
 -Dcom.sun.management.jmxremote.authenticate&#x3D;false \
 -Dcom.sun.management.jmxremote.ssl&#x3D;false \
 -Djava.rmi.server.hostname&#x3D;10.0.0.9&quot; \
 
# 重启tomcat生效
systemctl restart tomcat</code></pre></div></figure>

<p>选项说明</p>
<table>
<thead>
<tr>
<th>开启远程监控功能选项</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>-Dcom.sun.management.jmxremote</td>
<td>开启远程监控功能</td>
<td></td>
</tr>
<tr>
<td>-Dcom.sun.management.jmxremote.port&#x3D;12345</td>
<td>指定端口</td>
<td></td>
</tr>
<tr>
<td>-Dcom.sun.management.jmxremote.authenticate&#x3D;false</td>
<td>关闭认证功能</td>
<td></td>
</tr>
<tr>
<td>-Dcom.sun.management.jmxremote.ssl&#x3D;false</td>
<td>关闭ssl加密功能</td>
<td></td>
</tr>
<tr>
<td>-Djava.rmi.server.hostname&#x3D;10.0.0.9</td>
<td>写上本地网卡的ip,监听的地址.</td>
<td>未来需要修改的.</td>
</tr>
</tbody></table>
<h3 id="6-9-3-验证"><a href="#6-9-3-验证" class="headerlink" title="6.9.3 验证"></a>6.9.3 验证</h3><p>配置完监控后，Tomcat的java进程有什么改变？</p>
<ul>
<li>可以看到tomcat配置的监控信息</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">[root@web03[ &#x2F;app&#x2F;tools&#x2F;tomcat]#ps -ef | grep java
root      13476      1  2 14:19 ?        00:00:05 &#x2F;app&#x2F;tools&#x2F;jdk&#x2F;bin&#x2F;java -Djava.util.logging.config.file&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;conf&#x2F;logging.properties -Djava.util.logging.manager&#x3D;org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize&#x3D;2048 -Djava.protocol.handler.pkgs&#x3D;org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK&#x3D;0027 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port&#x3D;12345 -Dcom.sun.management.jmxremote.authenticate&#x3D;false -Dcom.sun.management.jmxremote.ssl&#x3D;false -Djava.rmi.server.hostname&#x3D;10.0.0.9 -Dignore.endorsed.dirs&#x3D; -classpath &#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;bootstrap.jar:&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;bin&#x2F;tomcat-juli.jar -Dcatalina.base&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat -Dcatalina.home&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat -Djava.io.tmpdir&#x3D;&#x2F;app&#x2F;tools&#x2F;tomcat&#x2F;temp org.apache.catalina.startup.Bootstrap start</code></pre></div></figure>



<p>在windows下，通过JDK连接tomcat，模拟监控软件连接</p>
<blockquote>
<p>C:\Program Files\Java\jdk1.8.0_201\bin\jconsole.exe  </p>
</blockquote>
<p>执行：</p>
<p><img src="/../../../img/image-20240513142656034.png" srcset="/img/loading.gif" lazyload alt="image-20240513142656034"></p>
<p>选择不安全连接</p>
<p><img src="/../../../img/image-20240513142716314.png" srcset="/img/loading.gif" lazyload alt="image-20240513142716314"></p>
<p>连接成功</p>
<p><img src="/../../../img/image-20240513142730577.png" srcset="/img/loading.gif" lazyload alt="image-20240513142730577"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%BF%90%E7%BB%B4/" class="category-chain-item">运维</a>
  
  
    <span>></span>
    
  <a href="/categories/%E8%BF%90%E7%BB%B4/%EF%BC%88%E4%BA%8C%EF%BC%89%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/" class="category-chain-item">（二）综合架构</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>17-Web集群-Tomcat(一)</div>
      <div>http://gsproj.github.io/2024/05/11/07_85期运维/02_综合架构/18-web集群-Tomcat-1/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>GongSheng</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年5月11日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/05/13/07_85%E6%9C%9F%E8%BF%90%E7%BB%B4/02_%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/19-web%E9%9B%86%E7%BE%A4-Tomcat-2-%E5%AE%8C%E7%BB%93/" title="17-Web集群-Tomcat(二)">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">17-Web集群-Tomcat(二)</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/05/10/07_85%E6%9C%9F%E8%BF%90%E7%BB%B4/02_%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/17-web%E9%9B%86%E7%BE%A4-Nginx-7-%E5%AE%8C%E7%BB%93/" title="17-Web集群-Nginx(七)">
                        <span class="hidden-mobile">17-Web集群-Nginx(七)</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.29.0/components/prism-core.min.js" ></script>

  <script  src="https://lib.baomitu.com/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js" ></script>

  <script  src="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
