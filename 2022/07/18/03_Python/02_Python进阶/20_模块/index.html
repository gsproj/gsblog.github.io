

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="GongSheng">
  <meta name="keywords" content="">
  
    <meta name="description" content="一 模块介绍在Python中，一个py文件就是一个模块，文件名为xxx.py模块名则是xxx,导入模块可以引用模块中已经写好的功能。如果把开发程序比喻成制造一台电脑，编写模块就像是在制造电脑的零部件，准备好零部件后，剩下的工作就是按照逻辑把它们组装到一起。 将程序模块化会使得程序的组织结构清晰，维护起来更加方便。比起直接开发一个完整的程序，单独开发一个小的模块也会更加简单，并且程序中的模块与电脑中">
<meta property="og:type" content="article">
<meta property="og:title" content="20-模块">
<meta property="og:url" content="http://gsproj.github.io/2022/07/18/03_Python/02_Python%E8%BF%9B%E9%98%B6/20_%E6%A8%A1%E5%9D%97/index.html">
<meta property="og:site_name" content="迎风之豚的博客">
<meta property="og:description" content="一 模块介绍在Python中，一个py文件就是一个模块，文件名为xxx.py模块名则是xxx,导入模块可以引用模块中已经写好的功能。如果把开发程序比喻成制造一台电脑，编写模块就像是在制造电脑的零部件，准备好零部件后，剩下的工作就是按照逻辑把它们组装到一起。 将程序模块化会使得程序的组织结构清晰，维护起来更加方便。比起直接开发一个完整的程序，单独开发一个小的模块也会更加简单，并且程序中的模块与电脑中">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-884e2868bde505c7fb7232f576bbcfdb_720w.jpg">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-d0708c002191a57754895d0ed4d05262_720w.jpg">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-506cce5c2b597bfe50f9644086cb2258_720w.jpg">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-13b67a1601f0ad7ca5f461fb17a631ce_720w.jpg">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-a7d712d021543c75a8f4be75999cee1e_720w.jpg">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-46fbc37fa93302dfacd0803f7d78715d_720w.jpg">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-415ea58d416900ea166573cb65543080_720w.jpg">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-991b007f2b930863c768b479e0f303eb_720w.jpg">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-99a7e78c8f88bf5e443c03d3b94183ca_720w.jpg">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-ba9d3d04398d89655c579c67cbe9f9f1_720w.jpg">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-b380918dbff3c80f06c3e47d778b913e_720w.jpg">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-d10449104b8d634196b784b31ab1f0e3_720w.jpg">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-c8e40baa1976d8e26f75f0fa2ceb5cd5_720w.jpg">
<meta property="og:image" content="https://pic2.zhimg.com/80/v2-0aa2d5e22f88e3b8b8f4b6f2fdfb76b1_720w.jpg">
<meta property="og:image" content="https://pic4.zhimg.com/v2-c64ada0dd06d0c57ed905be65d17acb7_180x120.jpg">
<meta property="article:published_time" content="2022-07-18T01:34:22.000Z">
<meta property="article:modified_time" content="2024-08-02T01:48:34.346Z">
<meta property="article:author" content="GongSheng">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://pic4.zhimg.com/80/v2-884e2868bde505c7fb7232f576bbcfdb_720w.jpg">
  
  
  
  <title>20-模块 - 迎风之豚的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"gsproj.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Haris的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="20-模块"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-07-18 09:34" pubdate>
          2022年7月18日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.9k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          33 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">20-模块</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="一-模块介绍"><a href="#一-模块介绍" class="headerlink" title="一 模块介绍"></a>一 模块介绍</h2><p>在Python中，一个py文件就是一个模块，文件名为xxx.py模块名则是xxx,导入模块可以引用模块中已经写好的功能。如果把开发程序比喻成制造一台电脑，编写模块就像是在制造电脑的零部件，准备好零部件后，剩下的工作就是按照逻辑把它们组装到一起。</p>
<p>将程序模块化会使得程序的组织结构清晰，维护起来更加方便。比起直接开发一个完整的程序，单独开发一个小的模块也会更加简单，并且程序中的模块与电脑中的零部件稍微不同的是：程序中的模块可以被重复使用。所以总结下来，使用模块既保证了代码的重用性，又增强了程序的结构性和可维护性。另外除了自定义模块外，我们还可以导入使用内置或第三方模块提供的现成功能，这种“拿来主义”极大地提高了程序员的开发效率。</p>
<h2 id="二-模块的使用"><a href="#二-模块的使用" class="headerlink" title="二 模块的使用"></a>二 模块的使用</h2><h2 id="2-1-import语句"><a href="#2-1-import语句" class="headerlink" title="2.1 import语句"></a>2.1 import语句</h2><p>有如下示范文件</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">#文件名：foo.py
x&#x3D;1
def get():
    print(x)
def change():
    global x
    x&#x3D;0
class Foo:
    def func(self):
       print(&#39;from the func&#39;)</code></pre></div></figure>

<p>要想在另外一个py文件中引用foo.py中的功能，需要使用import foo，首次导入模块会做三件事：</p>
<p>1、执行源文件代码</p>
<p>2、产生一个新的名称空间用于存放源文件执行过程中产生的名字</p>
<p>3、在当前执行文件所在的名称空间中得到一个名字foo，该名字指向新创建的模块名称空间，若要引用模块名称空间中的名字，需要加上该前缀，如下</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">import foo #导入模块foo
a&#x3D;foo.x #引用模块foo中变量x的值赋值给当前名称空间中的名字a
foo.get() #调用模块foo的get函数
foo.change() #调用模块foo中的change函数
obj&#x3D;foo.Foo() #使用模块foo的类Foo来实例化，进一步可以执行obj.func()</code></pre></div></figure>

<p>加上foo.作为前缀就相当于指名道姓地说明要引用foo名称空间中的名字，所以肯定不会与当前执行文件所在名称空间中的名字相冲突，并且若当前执行文件的名称空间中存在x，执行foo.get()或foo.change()操作的都是源文件中的全局变量x。</p>
<p><img src="https://pic4.zhimg.com/80/v2-884e2868bde505c7fb7232f576bbcfdb_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>需要强调一点是，第一次导入模块已经将其加载到内存空间了，之后的重复导入会直接引用内存中已存在的模块，不会重复执行文件，通过import sys，打印sys.modules的值可以看到内存中已经加载的模块名。</p>
<p>提示：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">#1、在Python中模块也属于第一类对象，可以进行赋值、以数据形式传递以及作为容器类型的元素等操作。
#2、模块名应该遵循小写形式，标准库从python2过渡到python3做出了很多这类调整，比如ConfigParser、Queue、SocketServer全更新为纯小写形式。</code></pre></div></figure>

<p><img src="https://pic3.zhimg.com/80/v2-d0708c002191a57754895d0ed4d05262_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>用import语句导入多个模块，可以写多行import语句</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">import module1
import module2
    ...
import moduleN</code></pre></div></figure>

<p>还可以在一行导入，用逗号分隔开不同的模块</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">import module1,module2,...,moduleN</code></pre></div></figure>

<p>但其实第一种形式更为规范，可读性更强，推荐使用，而且我们导入的模块中可能包含有python内置的模块、第三方的模块、自定义的模块，为了便于明显地区分它们，我们通常在文件的开头导入模块，并且分类导入，一类模块的导入与另外一类的导入用空行隔开，不同类别的导入顺序如下：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">#1. python内置模块
#2. 第三方模块
#3. 程序员自定义模块</code></pre></div></figure>

<p> 当然，我们也可以在函数内导入模块，对比在文件开头导入模块属于全局作用域，在函数内导入的模块则属于局部的作用域。</p>
<p><img src="https://pic1.zhimg.com/80/v2-506cce5c2b597bfe50f9644086cb2258_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h2 id="2-2-from-import-语句"><a href="#2-2-from-import-语句" class="headerlink" title="2.2 from-import 语句"></a>2.2 from-import 语句</h2><p>from…import…与import语句基本一致，唯一不同的是：使用import foo导入模块后，引用模块中的名字都需要加上foo.作为前缀，而使用from foo import x,get,change,Foo则可以在当前执行文件中直接引用模块foo中的名字，如下</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">from foo import x,get,change #将模块foo中的x和get导入到当前名称空间
a&#x3D;x #直接使用模块foo中的x赋值给a
get() #直接执行foo中的get函数
change() #即便是当前有重名的x，修改的仍然是源文件中的x</code></pre></div></figure>

<p>无需加前缀的好处是使得我们的代码更加简洁，坏处则是容易与当前名称空间中的名字冲突，如果当前名称空间存在相同的名字，则后定义的名字会覆盖之前定义的名字。</p>
<p><img src="https://pic3.zhimg.com/80/v2-13b67a1601f0ad7ca5f461fb17a631ce_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>另外from语句支持from foo import <em>语法，</em>代表将foo中所有的名字都导入到当前位置</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">from foo import * #把foo中所有的名字都导入到当前执行文件的名称空间中，在当前位置直接可以使用这些名字

a&#x3D;x
get()
change()
obj&#x3D;Foo()</code></pre></div></figure>

<p>如果我们需要引用模块中的名字过多的话，可以采用上述的导入形式来达到节省代码量的效果，但是需要强调的一点是：只能在模块最顶层使用<em>的方式导入，在函数内则非法，并且</em>的方式会带来一种副作用，即我们无法搞清楚究竟从源文件中导入了哪些名字到当前位置，这极有可能与当前位置的名字产生冲突。模块的编写者可以在自己的文件中定义__all__变量用来控制*代表的意思</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">#foo.py
__all__&#x3D;[&#39;x&#39;,&#39;get&#39;] #该列表中所有的元素必须是字符串类型，每个元素对应foo.py中的一个名字
x&#x3D;1
def get():
    print(x)
def change():
    global x
    x&#x3D;0
class Foo:
    def func(self):
       print(&#39;from the func&#39;)</code></pre></div></figure>

<p>这样我们在另外一个文件中使用*导入时，就只能导入__all__定义的名字了</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">from foo import * #此时的*只代表x和get

x #可用
get() #可用
change() #不可用
Foo() #不可用</code></pre></div></figure>

<p><img src="https://pic3.zhimg.com/80/v2-a7d712d021543c75a8f4be75999cee1e_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h2 id="2-3-其他导入语法-as"><a href="#2-3-其他导入语法-as" class="headerlink" title="2.3 其他导入语法(as)"></a>2.3 其他导入语法(as)</h2><p>我们还可以在当前位置为导入的模块起一个别名</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">import foo as f #为导入的模块foo在当前位置起别名f，以后再使用时就用这个别名f
f.x
f.get()</code></pre></div></figure>

<p>还可以为导入的一个名字起别名</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">from foo import get as get_x
get_x()</code></pre></div></figure>

<p>通常在被导入的名字过长时采用起别名的方式来精简代码，另外为被导入的名字起别名可以很好地避免与当前名字发生冲突，还有很重要的一点就是：可以保持调用方式的一致性，例如我们有两个模块json和pickle同时实现了load方法，作用是从一个打开的文件中解析出结构化的数据，但解析的格式不同，可以用下述代码有选择性地加载不同的模块</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">if data_format &#x3D;&#x3D; &#39;json&#39;:
    import json as serialize #如果数据格式是json，那么导入json模块并命名为serialize
elif data_format &#x3D;&#x3D; &#39;pickle&#39;:
    import pickle as serialize #如果数据格式是pickle，那么导入pickle模块并命名为serialize

data&#x3D;serialize.load(fn) #最终调用的方式是一致的</code></pre></div></figure>

<p><img src="https://pic2.zhimg.com/80/v2-46fbc37fa93302dfacd0803f7d78715d_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h2 id="2-4-循环导入问题"><a href="#2-4-循环导入问题" class="headerlink" title="2.4 循环导入问题"></a>2.4 循环导入问题</h2><p><img src="https://pic1.zhimg.com/80/v2-415ea58d416900ea166573cb65543080_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>循环导入问题指的是在一个模块加载&#x2F;导入的过程中导入另外一个模块，而在另外一个模块中又返回来导入第一个模块中的名字，由于第一个模块尚未加载完毕，所以引用失败、抛出异常，究其根源就是在python中，同一个模块只会在第一次导入时执行其内部代码，再次导入该模块时，即便是该模块尚未完全加载完毕也不会去重复执行内部代码</p>
<p><strong>我们以下述文件为例，来详细分析循环&#x2F;嵌套导入出现异常的原因以及解决的方案</strong></p>
<p>m1.py</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">print(&#39;正在导入m1&#39;)
from m2 import y

x&#x3D;&#39;m1&#39;</code></pre></div></figure>

<p>m2.py</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">print(&#39;正在导入m2&#39;)
from m1 import x

y&#x3D;&#39;m2&#39;</code></pre></div></figure>

<p>run.py</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">import m1</code></pre></div></figure>

<p><strong>测试一</strong></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">#1、执行run.py会抛出异常
正在导入m1
正在导入m2
Traceback (most recent call last):
  File &quot;&#x2F;Users&#x2F;linhaifeng&#x2F;PycharmProjects&#x2F;pro01&#x2F;1 aaaa练习目录&#x2F;aa.py&quot;, line 1, in &lt;module&gt;
    import m1
  File &quot;&#x2F;Users&#x2F;linhaifeng&#x2F;PycharmProjects&#x2F;pro01&#x2F;1 aaaa练习目录&#x2F;m1.py&quot;, line 2, in &lt;module&gt;
    from m2 import y
  File &quot;&#x2F;Users&#x2F;linhaifeng&#x2F;PycharmProjects&#x2F;pro01&#x2F;1 aaaa练习目录&#x2F;m2.py&quot;, line 2, in &lt;module&gt;
    from m1 import x
ImportError: cannot import name &#39;x&#39;

#2、分析
先执行run.py---&gt;执行import m1，开始导入m1并运行其内部代码---&gt;打印内容&quot;正在导入m1&quot;
---&gt;执行from m2 import y 开始导入m2并运行其内部代码---&gt;打印内容“正在导入m2”---&gt;执行from m1 import x,由于m1已经被导入过了，所以不会重新导入，所以直接去m1中拿x，然而x此时并没有存在于m1中，所以报错</code></pre></div></figure>

<p><img src="https://pic4.zhimg.com/80/v2-991b007f2b930863c768b479e0f303eb_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><strong>测试二</strong></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">#1、执行文件不等于导入文件，比如执行m1.py不等于导入了m1
直接执行m1.py抛出异常
正在导入m1
正在导入m2
正在导入m1
Traceback (most recent call last):
  File &quot;&#x2F;Users&#x2F;linhaifeng&#x2F;PycharmProjects&#x2F;pro01&#x2F;1 aaaa练习目录&#x2F;m1.py&quot;, line 2, in &lt;module&gt;
    from m2 import y
  File &quot;&#x2F;Users&#x2F;linhaifeng&#x2F;PycharmProjects&#x2F;pro01&#x2F;1 aaaa练习目录&#x2F;m2.py&quot;, line 2, in &lt;module&gt;
    from m1 import x
  File &quot;&#x2F;Users&#x2F;linhaifeng&#x2F;PycharmProjects&#x2F;pro01&#x2F;1 aaaa练习目录&#x2F;m1.py&quot;, line 2, in &lt;module&gt;
    from m2 import y
ImportError: cannot import name &#39;y&#39;

#2、分析
执行m1.py，打印“正在导入m1”，执行from m2 import y ，导入m2进而执行m2.py内部代码---&gt;打印&quot;正在导入m2&quot;，执行from m1 import x，此时m1是第一次被导入，执行m1.py并不等于导入了m1，于是开始导入m1并执行其内部代码---&gt;打印&quot;正在导入m1&quot;，执行from m1 import y，由于m1已经被导入过了，所以无需继续导入而直接问m2要y，然而y此时并没有存在于m2中所以报错</code></pre></div></figure>

<p><img src="https://pic3.zhimg.com/80/v2-99a7e78c8f88bf5e443c03d3b94183ca_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><strong>解决方案</strong></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"># 方案一：导入语句放到最后，保证在导入时，所有名字都已经加载过
# 文件：m1.py
print(&#39;正在导入m1&#39;)

x&#x3D;&#39;m1&#39;

from m2 import y

# 文件：m2.py
print(&#39;正在导入m2&#39;)
y&#x3D;&#39;m2&#39;

from m1 import x

# 文件：run.py内容如下，执行该文件，可以正常使用
import m1
print(m1.x)
print(m1.y)

# 方案二：导入语句放到函数中，只有在调用函数时才会执行其内部代码
# 文件：m1.py
print(&#39;正在导入m1&#39;)

def f1():
    from m2 import y
    print(x,y)

x &#x3D; &#39;m1&#39;

# 文件：m2.py
print(&#39;正在导入m2&#39;)

def f2():
    from m1 import x
    print(x,y)

y &#x3D; &#39;m2&#39;

# 文件：run.py内容如下，执行该文件，可以正常使用
import m1

m1.f1()</code></pre></div></figure>

<p><strong>注意：循环导入问题大多数情况是因为程序设计失误导致，上述解决方案也只是在烂设计之上的无奈之举，在我们的程序中应该尽量避免出现循环&#x2F;嵌套导入，如果多个模块确实都需要共享某些数据，可以将共享的数据集中存放到某一个地方，然后进行导入</strong></p>
<p><img src="https://pic2.zhimg.com/80/v2-ba9d3d04398d89655c579c67cbe9f9f1_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h2 id="2-5-搜索模块的路径与优先级"><a href="#2-5-搜索模块的路径与优先级" class="headerlink" title="2.5 搜索模块的路径与优先级"></a>2.5 搜索模块的路径与优先级</h2><p>模块其实分为四个通用类别，分别是：</p>
<p>1、使用纯Python代码编写的py文件</p>
<p>2、包含一系列模块的包</p>
<p>3、使用C编写并链接到Python解释器中的内置模块</p>
<p>4、使用C或C++编译的扩展模块</p>
<p>在导入一个模块时，如果该模块已加载到内存中，则直接引用，否则会优先查找内置模块，然后按照从左到右的顺序依次检索sys.path中定义的路径，直到找模块对应的文件为止，否则抛出异常。sys.path也被称为模块的搜索路径，它是一个列表类型</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">&gt;&gt;&gt; sys.path
[&#39;&#39;,
&#39;&#x2F;Library&#x2F;Frameworks&#x2F;Python.framework&#x2F;Versions&#x2F;3.5&#x2F;lib&#x2F;python35.zip&#39;,
&#39;&#x2F;Library&#x2F;Frameworks&#x2F;Python.framework&#x2F;Versions&#x2F;3.5&#x2F;lib&#x2F;python3.5&#39;,
...,
&#39;&#x2F;Library&#x2F;Frameworks&#x2F;Python.framework&#x2F;Versions&#x2F;3.5&#x2F;lib&#x2F;python3.5&#x2F;site-packages&#39;</code></pre></div></figure>

<p>列表中的每个元素其实都可以当作一个目录来看：在列表中会发现有.zip或.egg结尾的文件，二者是不同形式的压缩文件，事实上Python确实支持从一个压缩文件中导入模块，我们也只需要把它们都当成目录去看即可。</p>
<p><img src="https://pic3.zhimg.com/80/v2-b380918dbff3c80f06c3e47d778b913e_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>sys.path中的第一个路径通常为空，代表执行文件所在的路径，所以在被导入模块与执行文件在同一目录下时肯定是可以正常导入的，而针对被导入的模块与执行文件在不同路径下的情况，为了确保模块对应的源文件仍可以被找到，需要将源文件foo.py所在的路径添加到sys.path中，假设foo.py所在的路径为&#x2F;pythoner&#x2F;projects&#x2F;</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">import sys
sys.path.append(r&#39;&#x2F;pythoner&#x2F;projects&#x2F;&#39;) #也可以使用sys.path.insert(……)

import foo #无论foo.py在何处,我们都可以导入它了</code></pre></div></figure>

<h2 id="2-6-区分py文件的两种用途"><a href="#2-6-区分py文件的两种用途" class="headerlink" title="2.6 区分py文件的两种用途"></a>2.6 区分py文件的两种用途</h2><p>一个Python文件有两种用途，一种被当主程序&#x2F;脚本执行，另一种被当模块导入，为了区别同一个文件的不同用途，每个py文件都内置了__name__变量，该变量在py文件被当做脚本执行时赋值为“__main__”,在py文件被当做模块导入时赋值为模块名</p>
<p><img src="https://pic4.zhimg.com/80/v2-d10449104b8d634196b784b31ab1f0e3_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>作为模块foo.py的开发者，可以在文件末尾基于__name__在不同应用场景下值的不同来控制文件执行不同的逻辑</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">#foo.py
...
if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    foo.py被当做脚本执行时运行的代码
else:
    foo.py被当做模块导入时运行的代码</code></pre></div></figure>

<p>通常我们会在if的子代码块中编写针对模块功能的测试代码，这样foo.py在被当做脚本运行时，就会执行测试代码，而被当做模块导入时则不用执行测试代码。</p>
<h2 id="2-7-编写一个规范的模块"><a href="#2-7-编写一个规范的模块" class="headerlink" title="2.7 编写一个规范的模块"></a>2.7 编写一个规范的模块</h2><p><img src="https://pic2.zhimg.com/80/v2-c8e40baa1976d8e26f75f0fa2ceb5cd5_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>我们在编写py文件时，需要时刻提醒自己，该文件既是给自己用的，也有可能会被其他人使用，因而代码的可读性与易维护性显得十分重要，为此我们在编写一个模块时最好按照统一的规范去编写，如下</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">#!&#x2F;usr&#x2F;bin&#x2F;env python #通常只在类unix环境有效,作用是可以使用脚本名来执行，而无需直接调用解释器。

&quot;The module is used to...&quot; #模块的文档描述

import sys #导入模块

x&#x3D;1 #定义全局变量,如果非必须,则最好使用局部变量,这样可以提高代码的易维护性,并且可以节省内存提高性能

class Foo: #定义类,并写好类的注释
    &#39;Class Foo is used to...&#39;
    pass

def test(): #定义函数,并写好函数的注释
    &#39;Function test is used to…&#39;
    pass

if __name__ &#x3D;&#x3D; &#39;__main__&#39;: #主程序
    test() #在被当做脚本执行时,执行此处的代码</code></pre></div></figure>

<p><img src="https://pic2.zhimg.com/80/v2-0aa2d5e22f88e3b8b8f4b6f2fdfb76b1_720w.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h2 id="视频链接："><a href="#视频链接：" class="headerlink" title="视频链接："></a>视频链接：</h2><p>模块的使用之import</p>
<p><a href="https://link.zhihu.com/?target=https://www.bilibili.com/video/av73342471?p=65">https://www.bilibili.com/video/av73342471?p=65www.bilibili.com/video/av73342471?p=65</a></p>
<p>模块的使用之from…import…</p>
<p><a href="https://link.zhihu.com/?target=https://www.bilibili.com/video/av73342471?p=66">python快速入门（一）_哔哩哔哩 (゜-゜)つロ 干杯~-bilibiliwww.bilibili.com/video/av73342471?p=66<img src="https://pic4.zhimg.com/v2-c64ada0dd06d0c57ed905be65d17acb7_180x120.jpg" srcset="/img/loading.gif" lazyload alt="img"></a></p>
<p>区分python文件的两种用途</p>
<p><a href="https://link.zhihu.com/?target=https://www.bilibili.com/video/av73342471?p=67">https://www.bilibili.com/video/av73342471?p=67www.bilibili.com/video/av73342471?p=67</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Python/" class="category-chain-item">Python</a>
  
  
    <span>></span>
    
  <a href="/categories/Python/02-Python%E8%BF%9B%E9%98%B6/" class="category-chain-item">02_Python进阶</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>20-模块</div>
      <div>http://gsproj.github.io/2022/07/18/03_Python/02_Python进阶/20_模块/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>GongSheng</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年7月18日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/07/18/03_Python/02_Python%E8%BF%9B%E9%98%B6/21_%E5%8C%85/" title="21-包">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">21-包</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/07/18/03_Python/02_Python%E8%BF%9B%E9%98%B6/19_%E9%9D%A2%E5%90%91%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0%E5%BC%8F/" title="19-面向过程和函数式">
                        <span class="hidden-mobile">19-面向过程和函数式</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.29.0/components/prism-core.min.js" ></script>

  <script  src="https://lib.baomitu.com/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js" ></script>

  <script  src="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
